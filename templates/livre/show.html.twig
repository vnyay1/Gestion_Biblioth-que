{% extends 'base.html.twig' %}

{% block title %}{{ livre.titre }}{% endblock %}

{% block body %}
    <div class="container">
        <h1>ğŸ“– {{ livre.titre }}</h1>

        {% for type, messages in app.flashes %}
            {% for message in messages %}
                <div class="alert alert-{{ type }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endfor %}

        <div class="livre-details">
            <div class="detail-row">
                <strong>Auteur :</strong> 
                <span>{{ livre.auteur.nom ?? 'Non dÃ©fini' }}</span>
            </div>
            
            <div class="detail-row">
                <strong>AnnÃ©e de publication :</strong> 
                <span>{{ livre.annePublication }}</span>
                {% if livre.isRecent() %}
                    <span class="badge badge-new">Nouveau</span>
                {% endif %}
            </div>
            
            <div class="detail-row">
                <strong>RÃ©sumÃ© :</strong>
                <p>{{ livre.resume ?? 'Aucun rÃ©sumÃ© disponible.' }}</p>
            </div>
            
            <div class="detail-row">
                <strong>DisponibilitÃ© :</strong>
                {% if livre.disponible %}
                    <span class="badge badge-success">âœ… Disponible</span>
                {% else %}
                    <span class="badge badge-danger">âŒ EmpruntÃ©</span>
                {% endif %}
            </div>
            
            <div class="detail-row">
                <strong>Date d'ajout :</strong> 
                <span>{{ livre.dateAjoutFormatted('d/m/Y Ã  H:i') }}</span>
            </div>
        </div>

        <div class="actions">
            <a href="{{ path('livre_edit', {id: livre.id}) }}" class="btn btn-warning">âœï¸ Modifier</a>
            
            {% if livre.disponible %}
                <form method="post" action="{{ path('livre_emprunter', {id: livre.id}) }}" style="display: inline;">
                    <input type="hidden" name="_token" value="{{ csrf_token('emprunter' ~ livre.id) }}">
                    <button type="submit" class="btn btn-primary">ğŸ“¤ Emprunter</button>
                </form>
            {% else %}
                <form method="post" action="{{ path('livre_retourner', {id: livre.id}) }}" style="display: inline;">
                    <input type="hidden" name="_token" value="{{ csrf_token('retourner' ~ livre.id) }}">
                    <button type="submit" class="btn btn-success">ğŸ“¥ Retourner</button>
                </form>
            {% endif %}

            <form method="post" action="{{ path('livre_delete', {id: livre.id}) }}" style="display: inline;" onsubmit="return confirm('ÃŠtes-vous sÃ»r de vouloir supprimer ce livre ?');">
                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ livre.id) }}">
                <button type="submit" class="btn btn-danger">ğŸ—‘ï¸ Supprimer</button>
            </form>

            <a href="{{ path('livre_index') }}" class="btn btn-secondary">ğŸ”™ Retour Ã  la liste</a>
        </div>
    </div>
{% endblock %}
